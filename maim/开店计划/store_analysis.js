function initEchart(id, option) {
  const chart = echarts.init(document.getElementById("chart-" + id));
  chart.clear();
  chart.setOption(option);
}

function dealSheetData3(data) {
  var xAxis = [];
  var series = [];
  data.sheetList[0].columnList.forEach(function (item) {
    item.m.forEach(function (v) {
      xAxis.push(v.sdd[0].n);
    });
  });
  data.sheetList[0].dataList.forEach(function (rowVal, i) {
    var itemArr = [];
    if (i == 0) {
      rowVal.forEach(function (cellVal) {
        itemArr.push(typeof cellVal.d != "undefined" ? floatNum.accMul(cellVal.d.toFixed(2), 1) : "-");
      });
      series.push(itemArr);
    } else {
      rowVal.forEach(function (cellVal) {
        itemArr.push(typeof cellVal.d != "undefined" ? cellVal.d.toFixed(2) : "-");
      });
      series.push(itemArr);
    }
  });
  console.log(series);

  return {
    series,
    xAxis,
  };
}

function R1C1(data, params) {
  var componentId = params.componentId;
  var chartData = dealSheetData3(data);
  var option = {
    legend: {},
    tooltip: {
      trigger: "axis",
      axisPointer: {
        animation: false,
      },
    },
    xAxis: {
      type: "category",
      // name: '月份',
      data: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],
    },
    yAxis: {
      type: "value",
      min: 0.6,
      max: 1.6,
    },
    series: [
      {
        name: "季节性波动",
        data: chartData.series[0],
        type: "line",
        smooth: false,
      },
    ],
  };
  initEchart(componentId, option);
}

function R1C2(data, params) {
  var componentId = params.componentId;
  var chartData = dealSheetData3(data);
  var option = {
    legend: {},
    tooltip: {
      trigger: "axis",
      axisPointer: {
        animation: false,
      },
    },
    xAxis: {
      type: "category",
      // name: '月份',
      data: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],
    },
    yAxis: {
      type: "value",
      min: 0.6,
      max: 1.6,
    },
    series: [
      {
        name: "成长性分析",
        data: chartData.series[0],
        type: "line",
        smooth: false,
      },
    ],
  };
  initEchart(componentId, option);
}

let R2C1_params;
function R2C1(data, params) {
  R2C1_params = params;
  let componentId = params.componentId;

  let selectedData = [
    [
      [10.56, 1422.4],
      [8.46, 1540],
      [7.49, 1299.6],
      [7.84, 1313.6],
      [4.35, 1200],
      [5.76, 1230.4],
      [4.8, 1240],
      [4.04, 1161.6],
      [5.52, 1220.8],
      [4.72, 1188.8],
      [3.3, 1132],
      [4.24, 1169.6],
      [2.55, 960],
      [3.54, 1141.6],
      [2.04, 1081.6],
      [1.92, 1076.8],
      [0.89, 1035.6],
      [0.86, 1300],
      [1.04, 1041.6],
      [1.09, 1043.6],
      [8.56, 1342.4],
      [8.37, 1334.8],
      [9.6, 1384],
      [8.12, 1324.8],
      [8.26, 1330.4],
      [5.94, 1237.6],
      [5.05, 1202],
      [1.76, 1070.4],
      [3.48, 1139.2],
      [4.35, 940],
      [3.84, 1153.6],
      [13.91, 1556.4],
      [12.1, 1484],
      [3.03, 1121.2],
      [2.91, 1116.4],
      [2.4, 1096],
      [2.24, 1089.6],
      [1.12, 1044.8],
      [1.04, 1041.6],
      [7.07, 1282.8],
      [6.72, 1268.8],
      [7.02, 1760],
      [4.05, 1162],
      [4.8, 1080],
      [6.6, 1264],
      [4.72, 1188.8],
      [3.64, 1145.6],
      [3.51, 1140.4],
      [3.57, 1142.8],
      [2.1, 1084],
    ],
    [
      [10.56, 1422.4],
      [8.46, 1540],
      [7.49, 1299.6],
      [7.84, 1313.6],
      [4.35, 1200],
      [5.76, 1230.4],
      [4.8, 1240],
      [4.04, 1461.6],
      [5.52, 1220.8],
      [4.72, 1188.8],
      [3.3, 1132],
      [4.24, 1169.6],
      [2.55, 1960],
      [3.54, 1141.6],
      [2.04, 1681.6],
      [1.92, 1676.8],
      [0.89, 1035.6],
      [0.86, 1300],
      [1.04, 1041.6],
      [1.09, 1443.6],
      [8.56, 1342.4],
      [8.37, 1334.8],
      [9.6, 1084],
      [8.12, 1724.8],
      [8.26, 1330.4],
      [5.94, 1737.6],
      [5.05, 1802],
      [1.76, 1170.4],
      [3.48, 1139.2],
      [4.35, 940],
      [3.84, 1153.6],
      [13.91, 1556.4],
      [12.1, 1484],
      [3.03, 1121.2],
      [2.91, 1116.4],
      [2.4, 1096],
      [2.24, 1089.6],
      [1.12, 1044.8],
      [1.04, 1041.6],
      [7.07, 1782.8],
      [6.72, 1268.8],
      [7.02, 1760],
      [4.05, 1262],
      [4.8, 1380],
      [6.6, 1264],
      [4.72, 1188.8],
      [3.64, 1645.6],
      [3.51, 1140.4],
      [3.57, 1742.8],
      [2.1, 1784],
    ],
  ];

  let option = {
    grid: {
      left: "5%",
      right: "5%",
      top: "5%",
      bottom: "5%",
      containLabel: true,
    },
    xAxis: {},
    yAxis: {},
    series: [
      {
        symbolSize: 5,
        data: selectedData[Math.round(Math.random())],
        type: "scatter",
      },
    ],
  };
  initEchart(componentId, option);
}

let R2C2_params;
function R2C2(data, params) {
  R2C2_params = params;
  let componentId = params.componentId;

  let selectedData = [
    [
      [3670958.52, 488388.07],
      [4496475.27, 628186.98],
      [4408652.87, 692307.4],
      [1972519.68, 288084.35],
      [2755179.61, 363862.09],
      [3820076.17, 614549.31],
      [3965189.95, 506770.3],
      [2848914.07, 362981.19],
      [1764731.78, 263360.1],
      [9188698.17, 1428446.97],
      [4576871.23, 642810.47],
      [1942172.01, 230845.62],
      [4711216.77, 568652.62],
      [3983794.99, 524959.1],
      [3017805.36, 442232.69],
      [4838742.04, 680438.6],
      [3771021.83, 538742.09],
      [3346043.93, 446974.53],
      [3371116.43, 500325.71],
      [3040068.48, 390602.29],
      [3346043.93, 419878.34],
      [4637845.42, 602617.49],
      [6923658.07, 1064336.37],
      [3350716.48, 492597.53],
      [2961783.93, 370645.89],
      [2285618.04, 287856.37],
      [4081661.71, 533939.62],
      [5638153.96, 865355.96],
      [3154235.03, 411512.38],
      [4253126.73, 557001.72],
      [2918184.24, 458030.92],
      [3441423.85, 445593.5],
      [4367006.92, 615415.65],
      [4423876.88, 643915.15],
      [3927738.88, 564768.1],
      [5265547.38, 797225.93],
      [12541810.11, 1710903.54],
      [6368940.47, 800795.21],
      [2281508.55, 319729.49],
      [3667027.16, 504003.2],
      [2626253.33, 407736.22],
      [5297297.86, 628020.7],
      [1143613.69, 152950.31],
      [2880758.35, 381181.84],
      [5512570.61, 722086.1],
      [3040437.93, 431329.77],
      [4698339.12, 615234.51],
      [3179117.58, 471942.21],
      [4610654.48, 679247.65],
      [2129214.48, 273546.31],
    ],
    [
      [3670958.52, 588388.07],
      [4496475.27, 728186.98],
      [4408652.87, 392307.4],
      [1972519.68, 488084.35],
      [2755179.61, 663862.09],
      [3820076.17, 614549.31],
      [3965189.95, 706770.3],
      [2848914.07, 862981.19],
      [1764731.78, 263360.1],
      [9188698.17, 728446.97],
      [4576871.23, 342810.47],
      [1942172.01, 530845.62],
      [4711216.77, 368652.62],
      [3983794.99, 724959.1],
      [3017805.36, 342232.69],
      [4838742.04, 280438.6],
      [3771021.83, 338742.09],
      [3346043.93, 346974.53],
      [3371116.43, 300325.71],
      [3040068.48, 990602.29],
      [3346043.93, 219878.34],
      [4637845.42, 302617.49],
      [6923658.07, 1064336.37],
      [3350716.48, 492597.53],
      [2961783.93, 370645.89],
      [2285618.04, 287856.37],
      [4081661.71, 533939.62],
      [5638153.96, 865355.96],
      [3154235.03, 411512.38],
      [4253126.73, 557001.72],
      [2918184.24, 458030.92],
      [3441423.85, 445593.5],
      [4367006.92, 615415.65],
      [4423876.88, 643915.15],
      [3927738.88, 564768.1],
      [5265547.38, 797225.93],
      [12541810.11, 1710903.54],
      [6368940.47, 800795.21],
      [2281508.55, 319729.49],
      [3667027.16, 504003.2],
      [2626253.33, 407736.22],
      [5297297.86, 628020.7],
      [1143613.69, 152950.31],
      [2880758.35, 381181.84],
      [5512570.61, 722086.1],
      [3040437.93, 431329.77],
      [4698339.12, 615234.51],
      [3179117.58, 471942.21],
      [4610654.48, 679247.65],
      [2129214.48, 273546.31],
    ],
  ];

  let option = {
    grid: {
      left: "5%",
      right: "5%",
      top: "5%",
      bottom: "5%",
      containLabel: true,
    },
    xAxis: {},
    yAxis: {},
    series: [
      {
        symbolSize: 5,
        data: selectedData[Math.round(Math.random())],
        type: "scatter",
      },
    ],
  };
  initEchart(componentId, option);
}

$(() => {
  $("#dataHead")
    .find(".freshBS")
    .click(() => {
      R2C1(undefined,R2C1_params);
      R2C2(undefined,R2C2_params);
    });
});
